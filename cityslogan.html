<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë„ì‹œ ìŠ¬ë¡œê±´ & ë¡œê³  ìƒì„±ê¸°</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
        }
        
        .input-section {
            margin-bottom: 30px;
        }
        
        label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
            color: #555;
        }
        
        input[type="text"], input[type="password"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            box-sizing: border-box;
        }
        
        input[type="text"]:focus, input[type="password"]:focus {
            border-color: #4CAF50;
            outline: none;
        }
        
        button {
            background-color: #4CAF50;
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 10px;
        }
        
        button:hover {
            background-color: #45a049;
        }
        
        button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        
        .results {
            margin-top: 30px;
        }
        
        .translation-section, .slogan-section, .logo-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #fafafa;
        }
        
        .translation-section h3, .slogan-section h3, .logo-section h3 {
            margin-top: 0;
            color: #333;
        }
        
        .keywords {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }
        
        .keyword-tag {
            background-color: #e7f3ff;
            padding: 5px 10px;
            border-radius: 15px;
            border: 1px solid #b3d9ff;
            font-size: 14px;
        }
        
        .slogan {
            font-size: 18px;
            font-style: italic;
            color: #2c5aa0;
            margin-top: 10px;
            padding: 15px;
            background-color: #f0f8ff;
            border-left: 4px solid #2c5aa0;
        }
        
        .slogan-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .slogan-english {
            background-color: #f0f8ff;
            border-left: 4px solid #2c5aa0;
        }
        
        .slogan-korean {
            background-color: #f0fff0;
            border-left: 4px solid #4CAF50;
        }
        
        .slogan-label {
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 5px;
            color: #666;
        }
        
        .logo-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 15px;
        }
        
        .logo-item {
            text-align: center;
        }
        
        .logo-item img {
            max-width: 300px;
            max-height: 300px;
            border: 2px solid #ddd;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .loading {
            text-align: center;
            color: #666;
            font-style: italic;
        }
        
        .error {
            color: #d32f2f;
            background-color: #ffebee;
            padding: 10px;
            border-radius: 5px;
            border-left: 4px solid #d32f2f;
        }
        
        .api-info {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .api-info h4 {
            margin-top: 0;
            color: #856404;
        }
        
        .update-info {
            background-color: #e8f5e8;
            border: 1px solid #4CAF50;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .update-info h4 {
            margin-top: 0;
            color: #2e7d32;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ™ï¸ ë„ì‹œ ìŠ¬ë¡œê±´ & ë¡œê³  ìƒì„±ê¸°</h1>
            
        <div class="api-info">
            <h4>âš ï¸ API í‚¤ ì„¤ì • í•„ìš”</h4>
            <p>ì´ í”„ë¡œê·¸ë¨ì„ ì‚¬ìš©í•˜ë ¤ë©´ Google AI Studioì—ì„œ Gemini API í‚¤ë¥¼ ë°œê¸‰ë°›ì•„ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>
            <p><a href="https://aistudio.google.com/app/apikey" target="_blank">Google AI Studioì—ì„œ API í‚¤ ë°œê¸‰ë°›ê¸°</a></p>
        </div>
        
        <div class="input-section">
            <label for="apiKey">Gemini API í‚¤:</label>
            <input type="password" id="apiKey" placeholder="ì—¬ê¸°ì— API í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
        </div>
        
        <div class="input-section">
            <label for="keywords">ë„ì‹œ ê´€ë ¨ í‚¤ì›Œë“œ (ì‰¼í‘œë¡œ êµ¬ë¶„):</label>
            <input type="text" id="keywords" placeholder="ì˜ˆ: ë°”ë‹¤, ì‚°, ë¬¸í™”, ì—­ì‚¬, ë¯¸ë˜">
            <button onclick="generateCityContent()">ìƒì„±í•˜ê¸°</button>
        </div>
        
        <div class="results" id="results" style="display: none;">
            <div class="translation-section">
                <h3>ğŸ”¤ ë²ˆì—­ëœ í‚¤ì›Œë“œ</h3>
                <div id="translatedKeywords"></div>
            </div>
            
            <div class="slogan-section">
                <h3>âœ¨ ë„ì‹œ ìŠ¬ë¡œê±´</h3>
                <div id="citySlogan"></div>
            </div>
            
            <div class="logo-section">
                <h3>ğŸ¨ ë„ì‹œ ë¡œê³ </h3>
                <div id="cityLogos"></div>
            </div>
        </div>
    </div>

    <script type="module">
        // ë²ˆì—­ í•¨ìˆ˜
        async function translateKeywords(keywords, apiKey) {
            const prompt = `ë‹¤ìŒ í•œê¸€ í‚¤ì›Œë“œë“¤ì„ ì˜ì–´ë¡œ ë²ˆì—­í•´ì£¼ì„¸ìš”. ê° í‚¤ì›Œë“œëŠ” í•œ ì¤„ì— í•˜ë‚˜ì”©, "í•œê¸€: ì˜ì–´" í˜•ì‹ìœ¼ë¡œ ë‹µë³€í•´ì£¼ì„¸ìš”.

í‚¤ì›Œë“œ: ${keywords.join(', ')}`;

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: prompt
                            }]
                        }]
                    })
                });

                const data = await response.json();
                if (data.candidates && data.candidates[0]) {
                    const translationText = data.candidates[0].content.parts[0].text;
                    
                    // ë²ˆì—­ ê²°ê³¼ íŒŒì‹±
                    const translations = {};
                    const lines = translationText.split('\n');
                    
                    lines.forEach(line => {
                        const match = line.match(/(.+?):\s*(.+)/);
                        if (match) {
                            const korean = match[1].trim();
                            const english = match[2].trim();
                            translations[korean] = english;
                        }
                    });
                    
                    return translations;
                } else {
                    throw new Error('ë²ˆì—­ ì‘ë‹µì„ ë°›ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                }
            } catch (error) {
                console.error('ë²ˆì—­ ì˜¤ë¥˜:', error);
                throw error;
            }
        }

        // ìŠ¬ë¡œê±´ ìƒì„± í•¨ìˆ˜
        async function generateSlogan(englishKeywords, apiKey) {
            const prompt = `ë‹¤ìŒ í‚¤ì›Œë“œë“¤ì„ ë°”íƒ•ìœ¼ë¡œ ë§¤ë ¥ì ì´ê³  ê¸°ì–µì— ë‚¨ëŠ” ë„ì‹œ ìŠ¬ë¡œê±´ì„ ë§Œë“¤ì–´ì£¼ì„¸ìš”. ìŠ¬ë¡œê±´ì€ ì˜ì–´ë¡œ ì‘ì„±í•˜ê³ , ê°„ê²°í•˜ë©´ì„œë„ ë„ì‹œì˜ íŠ¹ì„±ì„ ì˜ í‘œí˜„í•´ì•¼ í•©ë‹ˆë‹¤.

í‚¤ì›Œë“œ: ${englishKeywords.join(', ')}

ìŠ¬ë¡œê±´ë§Œ ë‹µë³€í•´ì£¼ì„¸ìš”.`;

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: prompt
                            }]
                        }]
                    })
                });

                const data = await response.json();
                if (data.candidates && data.candidates[0]) {
                    return data.candidates[0].content.parts[0].text.trim();
                } else {
                    throw new Error('ìŠ¬ë¡œê±´ ìƒì„± ì‘ë‹µì„ ë°›ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                }
            } catch (error) {
                console.error('ìŠ¬ë¡œê±´ ìƒì„± ì˜¤ë¥˜:', error);
                throw error;
            }
        }

        // ìŠ¬ë¡œê±´ í•œêµ­ì–´ ë²ˆì—­ í•¨ìˆ˜
        async function translateSloganToKorean(englishSlogan, apiKey) {
            const prompt = `ë‹¤ìŒ ì˜ì–´ ë„ì‹œ ìŠ¬ë¡œê±´ì„ ìì—°ìŠ¤ëŸ½ê³  ë§¤ë ¥ì ì¸ í•œêµ­ì–´ë¡œ ë²ˆì—­í•´ì£¼ì„¸ìš”. ìŠ¬ë¡œê±´ì˜ ì˜ë¯¸ì™€ ê°ì„±ì„ ì˜ ì‚´ë ¤ì„œ ë²ˆì—­í•´ì£¼ì„¸ìš”.

ì˜ì–´ ìŠ¬ë¡œê±´: "${englishSlogan}"

í•œêµ­ì–´ ë²ˆì—­ë§Œ ë‹µë³€í•´ì£¼ì„¸ìš”.`;

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: prompt
                            }]
                        }]
                    })
                });

                const data = await response.json();
                if (data.candidates && data.candidates[0]) {
                    return data.candidates[0].content.parts[0].text.trim().replace(/"/g, '');
                } else {
                    throw new Error('ìŠ¬ë¡œê±´ ë²ˆì—­ ì‘ë‹µì„ ë°›ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                }
            } catch (error) {
                console.error('ìŠ¬ë¡œê±´ ë²ˆì—­ ì˜¤ë¥˜:', error);
                throw error;
            }
        }

        // Gemini 2.0 Flashë¥¼ ì‚¬ìš©í•œ ë¡œê³  ìƒì„± í•¨ìˆ˜
        async function generateLogosWithGemini2(englishKeywords, apiKey) {
            const prompt = `Create a modern and professional city logo design incorporating these keywords: ${englishKeywords.join(', ')}. The logo should be clean, memorable, and suitable for a city brand. Use vibrant colors and modern design elements. Make it visually appealing and distinctive.`;

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: prompt
                            }]
                        }],
                        generationConfig: {
                            response_modalities: ["TEXT", "IMAGE"]
                        }
                    })
                });

                const data = await response.json();
                console.log('Gemini 2.0 Flash ì‘ë‹µ:', data);
                
                if (data.candidates && data.candidates[0] && data.candidates[0].content && data.candidates[0].content.parts) {
                    const parts = data.candidates[0].content.parts;
                    const images = [];
                    
                    parts.forEach(part => {
                        if (part.inline_data && part.inline_data.data) {
                            images.push({
                                image: {
                                    imageBytes: part.inline_data.data
                                }
                            });
                        }
                    });
                    
                    if (images.length > 0) {
                        return images;
                    } else {
                        throw new Error('ìƒì„±ëœ ì´ë¯¸ì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    }
                } else {
                    throw new Error('ë¡œê³  ìƒì„± ì‘ë‹µì„ ë°›ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                }
            } catch (error) {
                console.error('Gemini 2.0 Flash ë¡œê³  ìƒì„± ì˜¤ë¥˜:', error);
                
                // ëŒ€ì²´ ë°©ë²•: í…ìŠ¤íŠ¸ ê¸°ë°˜ ë¡œê³  ì„¤ëª… ìƒì„±
                try {
                    const fallbackPrompt = `ë‹¤ìŒ í‚¤ì›Œë“œë“¤ì„ ë°”íƒ•ìœ¼ë¡œ ë„ì‹œ ë¡œê³ ì˜ ìƒì„¸í•œ ë””ìì¸ ì„¤ëª…ì„ ì‘ì„±í•´ì£¼ì„¸ìš”: ${englishKeywords.join(', ')}. ìƒ‰ìƒ, í˜•íƒœ, êµ¬ì„± ìš”ì†Œ ë“±ì„ êµ¬ì²´ì ìœ¼ë¡œ ì„¤ëª…í•´ì£¼ì„¸ìš”.`;
                    
                    const fallbackResponse = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent?key=${apiKey}`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            contents: [{
                                parts: [{
                                    text: fallbackPrompt
                                }]
                            }]
                        })
                    });
                    
                    const fallbackData = await fallbackResponse.json();
                    if (fallbackData.candidates && fallbackData.candidates[0]) {
                        return {
                            description: fallbackData.candidates[0].content.parts[0].text
                        };
                    }
                } catch (fallbackError) {
                    console.error('ëŒ€ì²´ ë°©ë²•ë„ ì‹¤íŒ¨:', fallbackError);
                }
                
                throw error;
            }
        }

        // ë©”ì¸ í•¨ìˆ˜
        window.generateCityContent = async function() {
            const apiKey = document.getElementById('apiKey').value.trim();
            const keywordsInput = document.getElementById('keywords').value.trim();
            
            if (!apiKey) {
                alert('API í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            if (!keywordsInput) {
                alert('í‚¤ì›Œë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            const keywords = keywordsInput.split(',').map(k => k.trim()).filter(k => k);
            
            if (keywords.length === 0) {
                alert('ìœ íš¨í•œ í‚¤ì›Œë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ê²°ê³¼ ì˜ì—­ í‘œì‹œ
            document.getElementById('results').style.display = 'block';
            
            // ë¡œë”© ìƒíƒœ í‘œì‹œ
            document.getElementById('translatedKeywords').innerHTML = '<div class="loading">ë²ˆì—­ ì¤‘...</div>';
            document.getElementById('citySlogan').innerHTML = '<div class="loading">ìŠ¬ë¡œê±´ ìƒì„± ì¤‘...</div>';
            document.getElementById('cityLogos').innerHTML = '<div class="loading">ë¡œê³  ìƒì„± ì¤‘...</div>';

            try {
                // 1. í‚¤ì›Œë“œ ë²ˆì—­
                const translations = await translateKeywords(keywords, apiKey);
                const englishKeywords = Object.values(translations);
                
                // ë²ˆì—­ ê²°ê³¼ í‘œì‹œ
                let translationHtml = '<div class="keywords">';
                for (const [korean, english] of Object.entries(translations)) {
                    translationHtml += `<div class="keyword-tag">${korean} â†’ ${english}</div>`;
                }
                translationHtml += '</div>';
                document.getElementById('translatedKeywords').innerHTML = translationHtml;

                // 2. ìŠ¬ë¡œê±´ ìƒì„± ë° ë²ˆì—­
                try {
                    const englishSlogan = await generateSlogan(englishKeywords, apiKey);
                    const koreanSlogan = await translateSloganToKorean(englishSlogan, apiKey);
                    
                    const sloganHtml = `
                        <div class="slogan-container">
                            <div class="slogan slogan-english">
                                <div class="slogan-label">ğŸ‡ºğŸ‡¸ ì˜ì–´ ìŠ¬ë¡œê±´</div>
                                "${englishSlogan}"
                            </div>
                            <div class="slogan slogan-korean">
                                <div class="slogan-label">ğŸ‡°ğŸ‡· í•œêµ­ì–´ ìŠ¬ë¡œê±´</div>
                                "${koreanSlogan}"
                            </div>
                        </div>
                    `;
                    
                    document.getElementById('citySlogan').innerHTML = sloganHtml;
                } catch (error) {
                    document.getElementById('citySlogan').innerHTML = `<div class="error">ìŠ¬ë¡œê±´ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${error.message}</div>`;
                }

                // 3. Gemini 2.0 Flashë¥¼ ì‚¬ìš©í•œ ë¡œê³  ìƒì„±
                try {
                    const logoResult = await generateLogosWithGemini2(englishKeywords, apiKey);
                    
                    if (logoResult.description) {
                        // í…ìŠ¤íŠ¸ ì„¤ëª…ë§Œ ìˆëŠ” ê²½ìš°
                        document.getElementById('cityLogos').innerHTML = `
                            <div class="error">
                                <h4>âš ï¸ ì´ë¯¸ì§€ ìƒì„± ì œí•œ</h4>
                                <p>í˜„ì¬ Gemini 2.0 Flashì˜ ì´ë¯¸ì§€ ìƒì„± ê¸°ëŠ¥ì´ ì œí•œë˜ì–´ ìˆìŠµë‹ˆë‹¤. ëŒ€ì‹  ë¡œê³  ë””ìì¸ ì„¤ëª…ì„ ì œê³µí•©ë‹ˆë‹¤:</p>
                                <div style="background: #f9f9f9; padding: 15px; border-radius: 5px; margin-top: 10px;">
                                    ${logoResult.description}
                                </div>
                            </div>
                        `;
                    } else if (Array.isArray(logoResult)) {
                        // ì´ë¯¸ì§€ê°€ ìƒì„±ëœ ê²½ìš°
                        let logoHtml = '<div class="logo-container">';
                        
                        logoResult.forEach((logo, index) => {
                            const imageData = logo.image.imageBytes;
                            logoHtml += `
                                <div class="logo-item">
                                    <img src="data:image/png;base64,${imageData}" alt="ë„ì‹œ ë¡œê³  ${index + 1}">
                                    <p>ë¡œê³  ${index + 1} (Gemini 2.0 Flash ìƒì„±)</p>
                                </div>
                            `;
                        });
                        
                        logoHtml += '</div>';
                        document.getElementById('cityLogos').innerHTML = logoHtml;
                    }
                } catch (error) {
                    document.getElementById('cityLogos').innerHTML = `
                        <div class="error">
                            <h4>ë¡œê³  ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤</h4>
                            <p>${error.message}</p>
                            <small>ì°¸ê³ : Gemini 2.0 Flashì˜ ì´ë¯¸ì§€ ìƒì„± ê¸°ëŠ¥ì€ í˜„ì¬ ì‹¤í—˜ì  ë‹¨ê³„ì…ë‹ˆë‹¤.</small>
                        </div>
                    `;
                }

            } catch (error) {
                document.getElementById('translatedKeywords').innerHTML = `<div class="error">ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${error.message}</div>`;
                console.error('ì „ì²´ ì²˜ë¦¬ ì˜¤ë¥˜:', error);
            }
        };
    </script>
</body>
</html>
